<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Quotient Analysis Report</title>
  </head>
  <body>
    <canvas id="scoreChart" width="300" height="200"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      const ctx = document.getElementById("scoreChart").getContext("2d");

      const score = 64;

      const values = [47, 3, 14, 3, 10, 3, 20];
      const colors = [
        "#FFA800",
        "transparent",
        "#FFC960",
        "transparent",
        "#FEEA3A",
        "transparent",
        "#7FE47E",
      ];

      new Chart(ctx, {
        type: "doughnut",
        data: {
          datasets: [
            {
              data: values,
              backgroundColor: colors,

              borderRadius: 8,
              borderWidth: 0,
              cutout: "92%",
              circumference: 180,
              rotation: 270,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: { enabled: false },
          },
        },
        plugins: [
          {
            id: "score-and-marker",
            afterDraw(chart) {
              const { ctx, chartArea, width } = chart;
              const cx = width / 2;
              const cy = chartArea.bottom;

              // Draw center score text
              ctx.save();
              ctx.font = "bold 32px sans-serif";
              ctx.fillStyle = "#1A1A2E";
              ctx.textAlign = "center";
              ctx.fillText(`${score}`, cx, cy - 10);
              ctx.font = "bold 14px sans-serif";
              ctx.fillText(`/100`, cx + 28, cy - 10);
              ctx.restore();

              // Draw yellow circle marker at top edge of arc
              const outerR = chart.outerRadius;
              const cutout =
                parseFloat(chart.config._config.data.datasets[0].cutout) / 100;
              const innerR = outerR * cutout;
              const radius = outerR - 4; // push toward outer edge

              const angle = Math.PI + (Math.PI * score) / 100;
              const x = cx + radius * Math.cos(angle);
              const y = cy + radius * Math.sin(angle);

              // Outer yellow circle (shadowed)
              ctx.beginPath();
              ctx.arc(x, y, 10, 0, 2 * Math.PI);
              ctx.fillStyle = "#FFF200";
              ctx.shadowColor = "#000";
              ctx.shadowBlur = 4;
              ctx.fill();

              // Inner white dot for highlight
              ctx.beginPath();
              ctx.arc(x, y, 5, 0, 2 * Math.PI);
              ctx.fillStyle = "#ffffff";
              ctx.shadowBlur = 0;
              ctx.fill();
            },
          },
        ],
      });
    </script>
  </body>
</html>
